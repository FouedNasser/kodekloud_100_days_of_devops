# Day 46: Deploy an App on Docker Containers

## Challenge Description
The Nautilus Application development team recently finished development of one of the apps that they want to deploy on a containerized platform. We need to test the deployment on App Server 3 (`stapp03`) and set up a complete containerized stack using a docker-compose file.

The requirements are:
1.  Create a docker compose file at `/opt/itadmin/docker-compose.yml` on App Server 3.
2.  Deploy two services: `web` and `db`.

**Web Service:**
*   Container name: `php_blog`
*   Image: `php` with any `apache` tag.
*   Port mapping: Host port `6400` to container port `80`.
*   Volume mapping: Host `/var/www/html` to container `/var/www/html`.

**DB Service:**
*   Container name: `mysql_blog`
*   Image: `mariadb` with any tag (preferably latest).
*   Port mapping: Host port `3306` to container port `3306`.
*   Volume mapping: Host `/var/lib/mysql` to container `/var/lib/mysql`.
*   Environment variables: `MYSQL_DATABASE=database_blog`, and a custom non-root user with a complex password.

## Key Concepts
*   **Docker Compose:** A tool for defining and running multi-container Docker applications.
*   **YAML:** The data serialization language used for configuration files like `docker-compose.yml`.
*   **Services:** The different parts of an application (e.g., web server, database) defined in the compose file.
*   **Volumes:** Used to persist data generated by and used by Docker containers.
*   **Environment Variables:** Used to configure the containers (e.g., setting database credentials).

## Solution
To solve this challenge, we logged into App Server 3 and created the required directory and `docker-compose.yml` file.

1.  **Login to App Server 3:**
    ```bash
    ssh banner@stapp03
    ```

2.  **Create the directory:**
    ```bash
    sudo mkdir -p /opt/itadmin
    ```

3.  **Create and edit the `docker-compose.yml` file:**
    ```bash
    sudo vi /opt/itadmin/docker-compose.yml
    ```

    We added the following content to the file:

    ```yaml
    version: '3'
    services:
      web:
        container_name: php_blog
        image: php:apache
        ports:
          - "6400:80"
        volumes:
          - /var/www/html:/var/www/html
        depends_on:
          - db

      db:
        container_name: mysql_blog
        image: mariadb:latest
        ports:
          - "3306:3306"
        volumes:
          - /var/lib/mysql:/var/lib/mysql
        environment:
          MYSQL_DATABASE: database_blog
          MYSQL_USER: blog_user
          MYSQL_PASSWORD: ComplexPassword123!
          MYSQL_ROOT_PASSWORD: RootComplexPassword123!
    ```

4.  **Deploy the stack:**
    We navigated to the directory and started the containers in detached mode:
    ```bash
    cd /opt/itadmin
    sudo docker-compose up -d
    ```

## Verification
To verify the deployment, we checked the running containers and tested access to the web service.

1.  **Check running containers:**
    ```bash
    sudo docker ps
    ```
    We verified that `php_blog` and `mysql_blog` were listed and up.

2.  **Test Web Access:**
    We used curl to access the web application on the mapped port:
    ```bash
    curl localhost:6400
    ```
